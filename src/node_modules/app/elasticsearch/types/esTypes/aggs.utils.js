import * as _ from 'lamb';
import {isObjEmpty} from '@svizzle/utils';

import {
	hasNoDefault,
	is_object,
	shapeKey
} from 'app/elasticsearch/types/genericTypes';
import {is_required} from 'app/elasticsearch/types/esTypes/params.utils';

// aggParams -> boolean
export const aggHasNoRequiredParams = _.allOf([
	is_object,
	_.pipe([
		_.skip([shapeKey, 'field']),
		_.pickIf(is_required),
		isObjEmpty
	])
]);

// aggParams -> boolean
export const aggHasNoRequiredParamsWithoutDefault = _.allOf([
	is_object,
	_.pipe([
		_.skip([shapeKey, 'field']),
		_.pickIf(_.allOf([is_required, hasNoDefault])),
		isObjEmpty
	])
]);
